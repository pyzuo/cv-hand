{"ast":null,"code":"var _jsxFileName = \"E:\\\\programming\\\\pycharm_series\\\\pycharm_file\\\\pythonfile\\\\cv-hand\\\\frontend\\\\src\\\\components\\\\WebcamCapture.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction WebcamCapture({\n  setResult\n}) {\n  _s();\n  const videoRef = useRef();\n  const canvasRef = useRef();\n  const [streaming, setStreaming] = useState(false);\n  const startCamera = async () => {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: true\n    });\n    videoRef.current.srcObject = stream;\n    setStreaming(true);\n  };\n  const stopCamera = () => {\n    const stream = videoRef.current.srcObject;\n    stream.getTracks().forEach(track => track.stop());\n    setStreaming(false);\n  };\n  const captureAndSend = async () => {\n    const context = canvasRef.current.getContext(\"2d\");\n    context.drawImage(videoRef.current, 0, 0, 224, 224);\n    canvasRef.current.toBlob(async blob => {\n      const formData = new FormData();\n      formData.append(\"file\", blob, \"capture.png\");\n      setResult(\"识别中...\");\n      try {\n        const res = await axios.post(\"http://localhost:5000/predict\", formData);\n        setResult(`识别结果: ${res.data.result} (置信度: ${(res.data.probability * 100).toFixed(2)}%)`);\n      } catch {\n        setResult(\"上传或识别出错\");\n      }\n    }, \"image/png\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"webcam-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"\\u6444\\u50CF\\u5934\\u5B9E\\u65F6\\u8BC6\\u522B:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        width: \"224\",\n        height: \"224\",\n        autoPlay: true,\n        muted: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: \"224\",\n        height: \"224\",\n        style: {\n          display: \"none\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, this), !streaming ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: startCamera,\n      children: \"\\u542F\\u52A8\\u6444\\u50CF\\u5934\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: captureAndSend,\n        children: \"\\u62CD\\u7167\\u8BC6\\u522B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: stopCamera,\n        children: \"\\u5173\\u95ED\\u6444\\u50CF\\u5934\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, this);\n}\n_s(WebcamCapture, \"Ze6RKHaAyqlhNjxnOZkYeOo7JYM=\");\n_c = WebcamCapture;\nexport default WebcamCapture;\nvar _c;\n$RefreshReg$(_c, \"WebcamCapture\");","map":{"version":3,"names":["React","useRef","useState","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","WebcamCapture","setResult","_s","videoRef","canvasRef","streaming","setStreaming","startCamera","stream","navigator","mediaDevices","getUserMedia","video","current","srcObject","stopCamera","getTracks","forEach","track","stop","captureAndSend","context","getContext","drawImage","toBlob","blob","formData","FormData","append","res","post","data","result","probability","toFixed","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","width","height","autoPlay","muted","style","display","onClick","_c","$RefreshReg$"],"sources":["E:/programming/pycharm_series/pycharm_file/pythonfile/cv-hand/frontend/src/components/WebcamCapture.js"],"sourcesContent":["import React, { useRef, useState } from \"react\";\nimport axios from \"axios\";\n\nfunction WebcamCapture({ setResult }) {\n  const videoRef = useRef();\n  const canvasRef = useRef();\n  const [streaming, setStreaming] = useState(false);\n\n  const startCamera = async () => {\n    const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n    videoRef.current.srcObject = stream;\n    setStreaming(true);\n  };\n\n  const stopCamera = () => {\n    const stream = videoRef.current.srcObject;\n    stream.getTracks().forEach((track) => track.stop());\n    setStreaming(false);\n  };\n\n  const captureAndSend = async () => {\n    const context = canvasRef.current.getContext(\"2d\");\n    context.drawImage(videoRef.current, 0, 0, 224, 224);\n    canvasRef.current.toBlob(async (blob) => {\n      const formData = new FormData();\n      formData.append(\"file\", blob, \"capture.png\");\n      setResult(\"识别中...\");\n      try {\n        const res = await axios.post(\"http://localhost:5000/predict\", formData);\n        setResult(`识别结果: ${res.data.result} (置信度: ${(res.data.probability * 100).toFixed(2)}%)`);\n      } catch {\n        setResult(\"上传或识别出错\");\n      }\n    }, \"image/png\");\n  };\n\n  return (\n    <div className=\"webcam-container\">\n      <label>摄像头实时识别:</label>\n      <div>\n        <video ref={videoRef} width=\"224\" height=\"224\" autoPlay muted />\n        <canvas ref={canvasRef} width=\"224\" height=\"224\" style={{ display: \"none\" }} />\n      </div>\n      {!streaming ? (\n        <button onClick={startCamera}>启动摄像头</button>\n      ) : (\n        <>\n          <button onClick={captureAndSend}>拍照识别</button>\n          <button onClick={stopCamera}>关闭摄像头</button>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default WebcamCapture;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}